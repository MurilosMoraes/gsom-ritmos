<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GDrums | Studio</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Header com Switch de Modo -->
    <header class="app-header">
      <div class="header-content">
        <div class="logo">
          <h1>GSOM</h1>
          <span class="logo-subtitle">Gold Sound on Music</span>
        </div>
        <div class="mode-switch">
          <span class="mode-label" id="modeLabel">Modo Usu√°rio</span>
          <label class="switch">
            <input type="checkbox" id="adminModeToggle">
            <span class="slider"></span>
          </label>
          <span class="mode-icon" id="modeIcon"></span>
        </div>
      </div>
    </header>

    <main class="app-main">
      <!-- ============= MODO USU√ÅRIO ============= -->
      <div id="userMode" class="mode-container active">
        <!-- Header com seletor de ritmo e controles -->
        <section class="user-header-section">
          <div class="user-header-controls">
            <div class="rhythm-selector-compact">
              <select id="rhythmSelectUser" class="rhythm-select-modern">
                <option value="">Selecione um ritmo...</option>
              </select>
              <button id="loadRhythmUser" class="btn-modern btn-primary">
                <span>Carregar</span>
              </button>
            </div>
            <div class="playback-main-controls">
              <button id="playStopUser" class="btn-playback-main btn-play">
                <span class="label">PLAY</span>
              </button>
            </div>
            <div class="tempo-compact">
              <button id="tempoDownUser" class="tempo-btn-compact">‚àí</button>
              <div class="tempo-display-compact" id="tempoDisplayUser">80</div>
              <button id="tempoUpUser" class="tempo-btn-compact">+</button>
              <span class="tempo-label">BPM</span>
            </div>
            <div class="volume-compact">
              <span class="volume-icon">üîä</span>
              <input type="range" id="masterVolumeUser" min="0" max="200" value="100" step="5" class="volume-slider-compact">
              <span class="volume-display-compact" id="volumeDisplayUser">100%</span>
            </div>
          </div>
        </section>

        <!-- Grid Principal: 3 colunas x 3 linhas -->
        <section class="user-grid-section">
          <div class="user-performance-grid">
            <!-- Linha 1: Ritmos Principais -->
            <div class="grid-cell rhythm-cell" data-type="main" data-variation="0">
              <span class="cell-label">RITMO 1</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell rhythm-cell" data-type="main" data-variation="1">
              <span class="cell-label">RITMO 2</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell rhythm-cell" data-type="main" data-variation="2">
              <span class="cell-label">RITMO 3</span>
              <div class="cell-indicator"></div>
            </div>

            <!-- Linha 2: Viradas -->
            <div class="grid-cell fill-cell" data-type="fill" data-variation="0">
              <span class="cell-label">VIRADA 1</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell fill-cell" data-type="fill" data-variation="1">
              <span class="cell-label">VIRADA 2</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell fill-cell" data-type="fill" data-variation="2">
              <span class="cell-label">VIRADA 3</span>
              <div class="cell-indicator"></div>
            </div>

            <!-- Linha 3: Finaliza√ß√£o e Transi√ß√µes -->
            <div class="grid-cell end-cell" data-type="end" data-variation="0">
              <span class="cell-label">FINAL 1</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell end-cell" data-type="end" data-variation="1">
              <span class="cell-label">FINAL 2</span>
              <div class="cell-indicator"></div>
            </div>
            <div class="grid-cell transition-cell" data-type="transition">
              <span class="cell-label">TRANSI√á√ÉO</span>
              <div class="cell-indicator"></div>
            </div>
          </div>
        </section>

        <!-- Status Bar -->
        <section class="user-status-bar">
          <div class="status-info">
            <span class="status-label">Status:</span>
            <span class="status-value" id="statusUser">Parado</span>
          </div>
          <div class="position-info">
            <span class="position-label">Posi√ß√£o:</span>
            <span class="position-value"><span id="currentStepUser">0</span>/16</span>
          </div>
          <div class="next-entry-info">
            <span class="entry-label">Pr√≥xima entrada:</span>
            <span class="entry-value" id="nextEntryUser">-</span>
          </div>
        </section>
      </div>

      <!-- ============= MODO ADMIN ============= -->
      <div id="adminMode" class="mode-container">
        <!-- Tabs de Padr√£o -->
        <section class="admin-section pattern-tabs-section">
          <h2>Editor de Padr√µes</h2>
          <div class="pattern-tabs-modern">
            <button class="pattern-tab" data-pattern="intro">
              <span class="tab-label">INTRO</span>
              <small>Contagem</small>
            </button>
            <button class="pattern-tab active" data-pattern="main">
              <span class="tab-label">PRINCIPAL</span>
              <small>Groove base</small>
            </button>
            <button class="pattern-tab" data-pattern="fill">
              <span class="tab-label">VIRADA</span>
              <small>Fill/Break</small>
            </button>
            <button class="pattern-tab" data-pattern="end">
              <span class="tab-label">FINAL</span>
              <small>Encerramento</small>
            </button>
          </div>
        </section>

        <!-- Controle de Varia√ß√µes -->
        <section class="admin-section variations-section">
          <h3>Varia√ß√µes do Padr√£o Atual</h3>
          <div class="variations-controls">
            <div class="variation-slots">
              <button class="variation-slot active" data-slot="0">
                <span class="slot-number">1</span>
              </button>
              <button class="variation-slot" data-slot="1">
                <span class="slot-number">2</span>
              </button>
              <button class="variation-slot" data-slot="2">
                <span class="slot-number">3</span>
              </button>
            </div>
            <div class="variation-actions">
              <button id="saveVariation" class="btn-admin btn-variation">
                <span>Salvar Varia√ß√£o</span>
              </button>
              <button id="loadVariation" class="btn-admin btn-variation">
                <span>Carregar Varia√ß√£o</span>
              </button>
            </div>
          </div>
        </section>

        <!-- Controle de Steps do Padr√£o -->
        <section class="admin-section steps-section">
          <h3>Quantidade de Steps</h3>
          <div class="steps-controls">
            <label for="patternStepsSelect">Steps:</label>
            <select id="patternStepsSelect" class="steps-select">
              <optgroup label="M√∫ltiplos de 3">
                <option value="3">3</option>
                <option value="6">6</option>
                <option value="12">12</option>
                <option value="18">18</option>
                <option value="24">24</option>
              </optgroup>
              <optgroup label="M√∫ltiplos de 4">
                <option value="4">4</option>
                <option value="8">8</option>
                <option value="16" selected>16</option>
                <option value="20">20</option>
                <option value="24">24</option>
                <option value="28">28</option>
                <option value="32">32</option>
              </optgroup>
            </select>
            <span id="currentStepsDisplay" class="steps-display">16 steps</span>
          </div>
        </section>

        <!-- Sequenciador Grid -->
        <section class="admin-section sequencer-section">
          <div id="sequencer" class="sequencer-modern">
            <!-- Canais ser√£o gerados dinamicamente -->
          </div>
        </section>

        <!-- Controles Admin -->
        <div class="admin-controls-wrapper">
          <!-- Controles de Playback Admin -->
          <section class="admin-section admin-playback">
            <h3>Reprodu√ß√£o</h3>
            <div class="controls-grid">
              <button id="playStop" class="btn-admin btn-play-admin">
                <span>PLAY</span>
              </button>
              <button id="fill" class="btn-admin btn-secondary-admin">
                <span>FILL</span>
              </button>
              <button id="end" class="btn-admin btn-secondary-admin">
                <span>END</span>
              </button>
            </div>
          </section>

          <!-- Controle de Tempo Admin -->
          <section class="admin-section tempo-config">
            <h3>Configura√ß√µes de Tempo</h3>
            <div class="config-row">
              <label>BPM:</label>
              <div class="input-group">
                <button id="tempoDown" class="btn-small">‚àí</button>
                <input type="number" id="tempo" value="80" min="40" max="240" step="1">
                <button id="tempoUp" class="btn-small">+</button>
                <span class="value-display" id="tempoDisplay">80</span>
              </div>
              <input type="range" id="tempoSlider" min="40" max="240" value="80" step="1" class="range-input">
            </div>

            <div class="config-row">
              <label>Vel. FILL:</label>
              <div class="input-group">
                <button id="fillSpeedDown" class="btn-small">‚àí</button>
                <input type="number" id="fillSpeed" value="1" min="0.25" max="4" step="0.25">
                <button id="fillSpeedUp" class="btn-small">+</button>
                <span class="value-display" id="fillSpeedDisplay">1x</span>
              </div>
            </div>

            <div class="config-row">
              <label>Vel. END:</label>
              <div class="input-group">
                <button id="endSpeedDown" class="btn-small">‚àí</button>
                <input type="number" id="endSpeed" value="1" min="0.25" max="4" step="0.25">
                <button id="endSpeedUp" class="btn-small">+</button>
                <span class="value-display" id="endSpeedDisplay">1x</span>
              </div>
            </div>

            <div class="config-row">
              <label>Tamanho Virada:</label>
              <select id="fillSteps" class="select-input">
                <option value="4">4 steps</option>
                <option value="8">8 steps</option>
                <option value="16" selected>16 steps</option>
                <option value="32">32 steps</option>
              </select>
            </div>

            <div class="config-row">
              <label>Volume Master:</label>
              <div class="input-group">
                <input type="range" id="masterVolume" min="0" max="200" value="100" step="5" class="range-input">
                <span class="value-display" id="masterVolumeDisplay">100%</span>
              </div>
            </div>
          </section>

          <!-- Configura√ß√£o de Sons -->
          <section class="admin-section sound-config">
            <h3>Sons Especiais</h3>

            <div class="sound-config-item">
              <label>Som de In√≠cio:</label>
              <div class="file-select-group">
                <select id="fillStartSelect" class="select-input">
                  <option value="">Nenhum</option>
                </select>
                <input type="file" id="fillStartCustomInput" accept="audio/*" class="file-input-hidden">
                <button id="fillStartCustomBtn" class="btn-file">
                  <span>Procurar</span>
                </button>
              </div>
              <span id="fillStartFileName" class="file-name-display"></span>
            </div>

            <div class="sound-config-item">
              <label>Som de Retorno:</label>
              <div class="file-select-group">
                <select id="fillReturnSelect" class="select-input">
                  <option value="">Nenhum</option>
                </select>
                <input type="file" id="fillReturnCustomInput" accept="audio/*" class="file-input-hidden">
                <button id="fillReturnCustomBtn" class="btn-file">
                  <span>Procurar</span>
                </button>
              </div>
              <span id="fillReturnFileName" class="file-name-display"></span>
            </div>
          </section>

          <!-- Salvar/Carregar -->
          <section class="admin-section save-load-section">
            <h3>Gerenciar Padr√µes</h3>
            <div class="button-grid">
              <button id="savePattern" class="btn-admin btn-save">
                <span>Salvar Padr√£o</span>
              </button>
              <button id="loadPattern" class="btn-admin btn-load">
                <span>Carregar Padr√£o</span>
              </button>
              <input type="file" id="loadFile" accept=".json" class="file-input-hidden">

              <button id="saveAll" class="btn-admin btn-save-all">
                <span>Salvar Projeto</span>
              </button>
              <button id="loadAll" class="btn-admin btn-load">
                <span>Carregar Projeto</span>
              </button>
              <input type="file" id="loadAllFile" accept=".json" class="file-input-hidden">

              <button id="clearPattern" class="btn-admin btn-clear">
                <span>Limpar Padr√£o</span>
              </button>
            </div>
          </section>

          <!-- Carregar Ritmos Salvos -->
          <section class="admin-section rhythm-library">
            <h3>Biblioteca de Ritmos</h3>
            <div class="rhythm-load-group">
              <select id="rhythmSelect" class="select-input">
                <option value="">Selecione um ritmo...</option>
              </select>
              <button id="loadRhythm" class="btn-admin">Carregar</button>
              <button id="refreshRhythms" class="btn-admin btn-refresh">Atualizar</button>
            </div>
          </section>

          <!-- Status Admin -->
          <section class="admin-section admin-status">
            <div class="status-grid">
              <div class="status-item-admin">
                <span class="label">Status:</span>
                <span class="value" id="status">Parado</span>
              </div>
              <div class="status-item-admin">
                <span class="label">Posi√ß√£o:</span>
                <span class="value"><span id="currentStep">0</span>/16</span>
              </div>
            </div>
          </section>
        </div>
      </div>
    </main>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
